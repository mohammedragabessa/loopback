sudo: false
language: node_js

cache: npm

node_js:
  - '10'

services:
 - docker

script: npm run test
install: npm install

branches:
  only:
    - master

# before_deploy:
DOCKER_IMAGE_NAME=loopbacktravis
DOCKER_IMAGE_TAG=latest
deploy:
  provider: script
  script:
   echo "$(DOCKER_PASSWORD)" | docker login -u "$(DOCKER_USERNAME)" --password-stdin
   docker tag $(DOCKER_IMAGE_NAME) mohamedragabessa/$(DOCKER_IMAGE_NAME):latest
   docker push mohamedragabessa/$(DOCKER_IMAGE_NAME):latest

  #  docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD" 

  #  echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin

  #  docker tag mohamedragabessa/loopbacktravis:latest mohamedragabessa/loopbacktravis:v0.0.1
  # echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin &&
  on:
    branch: master

# after_deploy:

# export TRAVIS_WORKER_DOCKER_BINDS='/var/run/docker.sock:/var/run/docker.sock'
